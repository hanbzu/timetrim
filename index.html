<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Timetrim</title>
    <style>
      .axis {
        cursor: default;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }
      .events circle {
        fill: rgba(155, 155, 155, 0.5);
      }
      .trim circle {
        fill: white;
        stroke: gray;
        stroke-width: 2;
      }
      .trim circle:hover {

      }
    </style>
  </head>
  <body>

    <div id="chart"></div>

    <!-- Placed at the end of the document so the pages load faster -->
    <script src="bower_components/d3/d3.min.js" charset="utf-8"></script>
    <script src="bower_components/moment/moment.js" charset="utf-8"></script>
    <script src="timetrim.js" charset="utf-8"></script>
    <script>
      function convert(_) {
        return moment("2013-02-08 " + _)
      }

      function convertUnix(_) {
        return _.unix()
      }

      var domain = [ '05:00', '24:00' ].map(convert),
          trim = [ '05', '24' ].map(convert),
          trim2 = [ '07', '22' ].map(convert)

      var theChart = timetrim()
        .domain(domain.map(convertUnix))
        .trim(trim.map(convertUnix))
        .onUpdate(function() {
          console.log(
            "New trim limits",
            theChart.trim().map(function(_) {
              return moment(_, 'X').format('H:mm')
            })
          )  
        })

      var example_data = [ '08:32', '09:45', '11:13', '11:25', '12:10', '13', '15:30', '16:34', '18:32', '20:43', '21:23' ]
        .map(convert)
      
      d3.select('#chart')
        .datum(example_data.map(convertUnix))
        .call(theChart)
      
      window.setTimeout(function() {
          console.log("Auch!")
          theChart.trim(trim2.map(convertUnix))
          d3.select('#chart')
            .datum(example_data.map(convertUnix))
            .call(theChart)
        }, 1000)
      </script>
  </body>
</html>